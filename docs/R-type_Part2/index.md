# ğŸ—ï¸ ARCHITECTURE R-TYPE - Vue d'ensemble Dev C

## ğŸ“Š DIAGRAMME D'ARCHITECTURE COMPLÃˆTE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          R-TYPE ARCHITECTURE                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

COUCHE 1: NETWORKING (TCP/UDP)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ServerHub (TCP - Port 4242)                                     â”‚
    â”‚  - GÃ¨re Lobby                                                    â”‚
    â”‚  - Liste des rooms                                               â”‚
    â”‚  - CrÃ©ation/Join rooms                                           â”‚
    â”‚  - RoomManager                                                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚           â”‚           â”‚               â”‚
         â†“           â†“           â†“               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Room 1 â”‚  â”‚ Room 2 â”‚  â”‚ Room 3 â”‚  â”‚ Room N...  â”‚
    â”‚UDP:5001â”‚  â”‚UDP:5002â”‚  â”‚UDP:5003â”‚  â”‚UDP:5000+N  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚           â”‚           â”‚              â”‚
         â†“           â†“           â†“              â†“
    ServerRoom  ServerRoom  ServerRoom    ServerRoom
    (Process)   (Process)   (Process)     (Process)


COUCHE 2: GAME LOGIC (Server Authoritative)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    Chaque ServerRoom contient:
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ServerRoom                                                 â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
    â”‚  â”‚ GameServer (ECS Registry)                              â”‚â”‚
    â”‚  â”‚                                                        â”‚â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
    â”‚  â”‚  â”‚ Physics      â”‚  â”‚ Collision    â”‚  â”‚ Shooter     â”‚ â”‚â”‚
    â”‚  â”‚  â”‚ System       â”‚  â”‚ System       â”‚  â”‚ System      â”‚ â”‚â”‚
    â”‚  â”‚  â”‚ - Gravity    â”‚  â”‚ - Detection  â”‚  â”‚ - Auto fire â”‚ â”‚â”‚
    â”‚  â”‚  â”‚ - Velocity   â”‚  â”‚ - Resolution â”‚  â”‚ - Cooldown  â”‚ â”‚â”‚
    â”‚  â”‚  â”‚ - Boundaries â”‚  â”‚ - Damage     â”‚  â”‚             â”‚ â”‚â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
    â”‚  â”‚                                                        â”‚â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚â”‚
    â”‚  â”‚  â”‚ Spawn        â”‚  â”‚ Movement     â”‚                  â”‚â”‚
    â”‚  â”‚  â”‚ System       â”‚  â”‚ System       â”‚                  â”‚â”‚
    â”‚  â”‚  â”‚ - Enemies    â”‚  â”‚ - Input      â”‚                  â”‚â”‚
    â”‚  â”‚  â”‚ - Powerups   â”‚  â”‚ - Apply vel  â”‚                  â”‚â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
    â”‚                                                             â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
    â”‚  â”‚ Packet Processing                                      â”‚â”‚
    â”‚  â”‚ - InputPacket â†’ processPlayerInput()                   â”‚â”‚
    â”‚  â”‚ - Sequence number validation                           â”‚â”‚
    â”‚  â”‚ - Duplicate/OOO detection                              â”‚â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
    â”‚                                                             â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
    â”‚  â”‚ State Broadcasting                                     â”‚â”‚
    â”‚  â”‚ - GameStatePacket (20Hz)                               â”‚â”‚
    â”‚  â”‚ - Entity snapshots                                     â”‚â”‚
    â”‚  â”‚ - Score, game_over                                     â”‚â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


COUCHE 3: CLIENT (Graphical + Networking)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  r-type_graphical_client                                     â”‚
    â”‚                                                              â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ RTypeGame (State Machine)                              â”‚ â”‚
    â”‚  â”‚                                                        â”‚ â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
    â”‚  â”‚  â”‚  MENU    â”‚ â†’ â”‚  LOBBY   â”‚ â†’ â”‚    PLAYING       â”‚  â”‚ â”‚
    â”‚  â”‚  â”‚  State   â”‚   â”‚  State   â”‚   â”‚    State         â”‚  â”‚ â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
    â”‚  â”‚                                                        â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                                                              â”‚
    â”‚  MENU STATE:                                                 â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ - Singleplayer                                         â”‚ â”‚
    â”‚  â”‚ - Multiplayer  â† Transition vers LOBBY                 â”‚ â”‚
    â”‚  â”‚ - Options                                              â”‚ â”‚
    â”‚  â”‚ - Quit                                                 â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                                                              â”‚
    â”‚  LOBBY STATE:                                                â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ ClientHub (TCP)                                        â”‚ â”‚
    â”‚  â”‚ â”œâ”€ requestRoomList()                                   â”‚ â”‚
    â”‚  â”‚ â”œâ”€ createRoom(name)                                    â”‚ â”‚
    â”‚  â”‚ â””â”€ joinRoom(id)                                        â”‚ â”‚
    â”‚  â”‚                                                        â”‚ â”‚
    â”‚  â”‚ UI:                                                    â”‚ â”‚
    â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
    â”‚  â”‚ â”‚ ROOM NAME      PLAYERS    STATUS                â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚ TestRoom       2/4        Waiting        [JOIN] â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚ CoopMode       1/4        Waiting        [JOIN] â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚ HardcoreRun    4/4        In Game              â”‚  â”‚ â”‚
    â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
    â”‚  â”‚                                                        â”‚ â”‚
    â”‚  â”‚ [C] Create Room   [R] Refresh   [ESC] Back to Menu   â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                                                              â”‚
    â”‚  PLAYING STATE:                                              â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ ClientRoom (UDP)                                       â”‚ â”‚
    â”‚  â”‚ â”œâ”€ sendInput(InputPacket)                              â”‚ â”‚
    â”‚  â”‚ â”œâ”€ receiveState(GameStatePacket)                       â”‚ â”‚
    â”‚  â”‚ â””â”€ getCurrentRTT()                                     â”‚ â”‚
    â”‚  â”‚                                                        â”‚ â”‚
    â”‚  â”‚ Game Rendering:                                        â”‚ â”‚
    â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
    â”‚  â”‚ â”‚          R-TYPE GAME                            â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚                                                  â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚  [Player]  â†’â†’â†’â†’  [Enemy]  â†â†â†â†                 â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚                                                  â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚  Score: 1500           Lives: 3                 â”‚  â”‚ â”‚
    â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
    â”‚  â”‚                                                        â”‚ â”‚
    â”‚  â”‚ Network Metrics Overlay:                               â”‚ â”‚
    â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
    â”‚  â”‚ â”‚ ğŸ“¡ Network Metrics                              â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚ RTT: 45ms          â˜…â˜…â˜…â˜…â˜†                        â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚ Loss: 0.1%                                      â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚ â†‘ Up: 8.3 KB/s                                  â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚ â†“ Down: 12.5 KB/s                               â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚ ğŸ“¦ Sent/Recv: 523/498                           â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚ FPS: 60                                         â”‚  â”‚ â”‚
    â”‚  â”‚ â”‚ [F3] Toggle                                     â”‚  â”‚ â”‚
    â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


COUCHE 4: PACKETS & COMPRESSION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    PacketsManager
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Serialization/Deserialization                             â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ InputPacket  â”‚  â”‚ GameState    â”‚  â”‚ Login/Logout    â”‚  â”‚
    â”‚  â”‚ - playerId   â”‚  â”‚ Packet       â”‚  â”‚ Packets         â”‚  â”‚
    â”‚  â”‚ - sequence   â”‚  â”‚ - frame      â”‚  â”‚                 â”‚  â”‚
    â”‚  â”‚ - moveUp/    â”‚  â”‚ - entities[] â”‚  â”‚                 â”‚  â”‚
    â”‚  â”‚   Down/etc   â”‚  â”‚ - score      â”‚  â”‚                 â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                                            â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ Ping/Pong    â”‚  â”‚ Spawn/       â”‚  â”‚ Room            â”‚  â”‚
    â”‚  â”‚ Packets      â”‚  â”‚ Destroy      â”‚  â”‚ Packets         â”‚  â”‚
    â”‚  â”‚ - pingId     â”‚  â”‚ Packets      â”‚  â”‚ - list          â”‚  â”‚
    â”‚  â”‚ - timestamp  â”‚  â”‚              â”‚  â”‚ - create        â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                                            â”‚
    â”‚  Compression (LZ4)                                         â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ GameStatePacket: 480 bytes â†’ 182 bytes (62% saving) â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                                                            â”‚
    â”‚  Encryption (XOR)                                          â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ Basic obfuscation for packet data                    â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                                                            â”‚
    â”‚  Metrics Tracking                                          â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ - recordPacketSent(bytes)                            â”‚ â”‚
    â”‚  â”‚ - recordPacketReceived(bytes)                        â”‚ â”‚
    â”‚  â”‚ - getMetrics() â†’ NetworkMetrics struct               â”‚ â”‚
    â”‚  â”‚   - packets_sent/received                            â”‚ â”‚
    â”‚  â”‚   - bytes_sent/received                              â”‚ â”‚
    â”‚  â”‚   - bandwidth_up/down KB/s                           â”‚ â”‚
    â”‚  â”‚   - avg_packet_size                                  â”‚ â”‚
    â”‚  â”‚   - uptime                                           â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


COUCHE 5: ECS (Entity Component System)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    Registry
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Entities                                                  â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ Entity 1 â”‚  â”‚ Entity 2 â”‚  â”‚ Entity 3 â”‚  â”‚ Entity N â”‚  â”‚
    â”‚  â”‚ Player 1 â”‚  â”‚ Enemy 1  â”‚  â”‚ Bullet 1 â”‚  â”‚ ...      â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                                            â”‚
    â”‚  Components (SparseArray)                                  â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ Position  â”‚ [x:100, y:200] [x:350, y:150] ...       â”‚ â”‚
    â”‚  â”‚ Velocity  â”‚ [vx:5, vy:0]   [vx:-2, vy:3]  ...       â”‚ â”‚
    â”‚  â”‚ Health    â”‚ [hp:100]       [hp:50]        ...       â”‚ â”‚
    â”‚  â”‚ Damage    â”‚ [dmg:10]       [dmg:25]       ...       â”‚ â”‚
    â”‚  â”‚ Sprite    â”‚ [tex:player]   [tex:enemy1]   ...       â”‚ â”‚
    â”‚  â”‚ Rigidbody â”‚ [DYNAMIC]      [KINEMATIC]    ...       â”‚ â”‚
    â”‚  â”‚ Gravity   â”‚ [fx:0,fy:9.8]  [none]         ...       â”‚ â”‚
    â”‚  â”‚ Boundary  â”‚ [0,800,0,600]  [0,800,0,600]  ...       â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                                                            â”‚
    â”‚  Systems (operate on Components)                           â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ PhysicsSystem:                                       â”‚ â”‚
    â”‚  â”‚   for entity with (Position, Velocity, Gravity):    â”‚ â”‚
    â”‚  â”‚     velocity += gravity * dt                        â”‚ â”‚
    â”‚  â”‚     position += velocity * dt                       â”‚ â”‚
    â”‚  â”‚     checkBoundaries(position, boundary)             â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                                                            â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ CollisionSystem:                                     â”‚ â”‚
    â”‚  â”‚   for entity1 with (Position, Hitbox):              â”‚ â”‚
    â”‚  â”‚     for entity2 with (Position, Hitbox):            â”‚ â”‚
    â”‚  â”‚       if collides(entity1, entity2):                â”‚ â”‚
    â”‚  â”‚         handleCollision(entity1, entity2)           â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                                                            â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ ShooterSystem:                                       â”‚ â”‚
    â”‚  â”‚   for entity with (ShooterComponent, Position):     â”‚ â”‚
    â”‚  â”‚     shootTimer += dt                                â”‚ â”‚
    â”‚  â”‚     if shootTimer >= shootInterval:                 â”‚ â”‚
    â”‚  â”‚       spawnBullet(position)                         â”‚ â”‚
    â”‚  â”‚       shootTimer = 0                                â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ FLOW DE DONNÃ‰ES COMPLET

### Flow 1: Connexion Initiale

```
Client                      ServerHub                 ServerRoom
  â”‚                            â”‚                          â”‚
  â”‚  TCP Connect (4242)        â”‚                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
  â”‚                            â”‚                          â”‚
  â”‚  LoginPacket               â”‚                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
  â”‚                            â”‚                          â”‚
  â”‚  LoginResponsePacket       â”‚                          â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                          â”‚
  â”‚  (success, playerId)       â”‚                          â”‚
  â”‚                            â”‚                          â”‚
  â”‚  requestRoomList()         â”‚                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
  â”‚                            â”‚                          â”‚
  â”‚  RoomListPacket            â”‚                          â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                          â”‚
  â”‚  [Room1, Room2, Room3...]  â”‚                          â”‚
  â”‚                            â”‚                          â”‚
  â”‚  joinRoom(roomId)          â”‚                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
  â”‚                            â”‚                          â”‚
  â”‚                            â”‚  SpawnRoom (if needed)   â”‚
  â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                            â”‚                          â”‚
  â”‚  RoomJoinedPacket          â”‚                          â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                          â”‚
  â”‚  (roomId, port:5001)       â”‚                          â”‚
  â”‚                            â”‚                          â”‚
  â”‚  Disconnect TCP            â”‚                          â”‚
  â”‚  Connect UDP (5001)        â”‚                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                            â”‚                          â”‚
```

### Flow 2: Game Loop (60Hz Client, 20Hz Server)

```
Client (60 FPS)              ServerRoom (20 TPS)         Client Render
     â”‚                            â”‚                            â”‚
     â”‚  Read Input                â”‚                            â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                  â”‚                            â”‚
     â”‚  (â†‘ pressed)               â”‚                            â”‚
     â”‚                            â”‚                            â”‚
     â”‚  InputPacket               â”‚                            â”‚
     â”‚  seq#142, moveUp=true      â”‚                            â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
     â”‚                            â”‚                            â”‚
     â”‚                            â”‚  Validate sequence         â”‚
     â”‚                            â”‚  (not duplicate/OOO)       â”‚
     â”‚                            â”‚                            â”‚
     â”‚                            â”‚  GameServer.               â”‚
     â”‚                            â”‚  processPlayerInput()      â”‚
     â”‚                            â”‚    â”‚                       â”‚
     â”‚                            â”‚    â†“                       â”‚
     â”‚                            â”‚  PhysicsSystem.update()    â”‚
     â”‚                            â”‚  - Apply velocity          â”‚
     â”‚                            â”‚  - Update position         â”‚
     â”‚                            â”‚    â”‚                       â”‚
     â”‚                            â”‚    â†“                       â”‚
     â”‚                            â”‚  CollisionSystem.update()  â”‚
     â”‚                            â”‚  - Check collisions        â”‚
     â”‚                            â”‚  - Apply damage            â”‚
     â”‚                            â”‚    â”‚                       â”‚
     â”‚                            â”‚    â†“                       â”‚
     â”‚                            â”‚  ShooterSystem.update()    â”‚
     â”‚                            â”‚  - Auto fire bullets       â”‚
     â”‚                            â”‚    â”‚                       â”‚
     â”‚                            â”‚    â†“                       â”‚
     â”‚                            â”‚  SpawnSystem.update()      â”‚
     â”‚                            â”‚  - Spawn enemies           â”‚
     â”‚                            â”‚                            â”‚
     â”‚  GameStatePacket           â”‚                            â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
     â”‚  frame#75, entities[...]   â”‚                            â”‚
     â”‚  score, gameOver           â”‚                            â”‚
     â”‚                            â”‚                            â”‚
     â”‚  applyGameState()          â”‚                            â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                            â”‚                    Update positions
     â”‚                            â”‚                    Update sprites
     â”‚                            â”‚                            â”‚
     â”‚  render()                  â”‚                            â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                            â”‚                    Draw background
     â”‚                            â”‚                    Draw entities
     â”‚                            â”‚                    Draw UI
     â”‚                            â”‚                    Draw metrics
     â”‚                            â”‚                    display()
```

### Flow 3: PING/PONG pour RTT

```
Client                      ServerRoom
  â”‚                            â”‚
  â”‚  PingPacket                â”‚
  â”‚  pingId=123                â”‚
  â”‚  timestamp=T1              â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚  Store (pingId, T1)        â”‚                
  â”‚                            â”‚
  â”‚                            â”‚  Receive Ping
  â”‚                            â”‚
  â”‚  PongPacket                â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  pingId=123                â”‚
  â”‚                            â”‚
  â”‚  Calculate RTT:            â”‚
  â”‚  T2 = now()                â”‚
  â”‚  RTT = T2 - T1             â”‚
  â”‚  _current_rtt = RTT        â”‚
  â”‚                            â”‚
```

### Flow 4: Network Metrics Update

```
PacketsManager              NetworkMetricsUI          Render
      â”‚                            â”‚                     â”‚
      â”‚  recordPacketSent()        â”‚                     â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â–º                   â”‚                     â”‚
      â”‚  _bytes_sent += 150        â”‚                     â”‚
      â”‚  _packets_sent++           â”‚                     â”‚
      â”‚                            â”‚                     â”‚
      â”‚  recordPacketReceived()    â”‚                     â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â–º                   â”‚                     â”‚
      â”‚  _bytes_received += 480    â”‚                     â”‚
      â”‚  _packets_received++       â”‚                     â”‚
      â”‚                            â”‚                     â”‚
      â”‚                            â”‚  update()           â”‚
      â”‚                            â”‚  (every 1 sec)      â”‚
      â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–º           â”‚
      â”‚                            â”‚                     â”‚
      â”‚  getMetrics()              â”‚                     â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
      â”‚  returns:                  â”‚                     â”‚
      â”‚  - packets_sent: 523       â”‚                     â”‚
      â”‚  - packets_received: 498   â”‚                     â”‚
      â”‚  - bandwidth_up: 8.3 KB/s  â”‚                     â”‚
      â”‚  - bandwidth_down: 12.5    â”‚                     â”‚
      â”‚                            â”‚                     â”‚
      â”‚                            â”‚  render()           â”‚
      â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
      â”‚                            â”‚              Draw overlay
      â”‚                            â”‚              with metrics
```

---

## ğŸ¯ MAPPING: TON TRAVAIL â†’ FEATURES JEU

### 1. Physics Systems â†’ Gameplay Mechanics

```cpp
// TON TRAVAIL
PhysicsSystem::update() {
    applyGravity();      // â† Entities tombent naturellement
    updateMovement();    // â† DÃ©placement fluide
    handleBoundary();    // â† Pas de sortie d'Ã©cran
}

// DANS LE JEU
- Les ennemis descendent progressivement (gravity)
- Les bullets se dÃ©placent Ã  vitesse constante (velocity)
- Les joueurs ne peuvent pas sortir de l'Ã©cran (boundary)
- Les powerups tombent du haut (gravity + kinematic)
```

### 2. Collision System â†’ Combat Mechanics

```cpp
// TON TRAVAIL
CollisionSystem::update() {
    for each entity pair:
        if collides(e1, e2):
            handleCollision(e1, e2)
}

// DANS LE JEU
- Player bullet + Enemy â†’ Damage enemy, destroy bullet
- Player + Enemy â†’ Damage player, knockback
- Player + Powerup â†’ Collect, upgrade weapon
- Enemy bullet + Player â†’ Damage player
```

### 3. Sequence Numbers â†’ Reliability

```cpp
// TON TRAVAIL (ServerRoom.cpp)
if (sequence <= lastSequence) {
    if (sequence == lastSequence) {
        // DUPLICATE â†’ ignore
    } else {
        // OUT-OF-ORDER â†’ ignore
    }
    return;
}
if (sequence > lastSequence + 1) {
    // PACKET LOSS detected
    std::cout << "Lost " << (sequence - lastSequence - 1) << " packets";
}

// DANS LE JEU
- Pas de double-tir si duplicate input
- Pas de retour en arriÃ¨re si out-of-order
- Logs montrant packet loss en temps rÃ©el
- Network metrics affichent reliability %
```

### 4. RTT Tracking â†’ Quality Indicators

```cpp
// TON TRAVAIL (ClientRoom.cpp)
_current_rtt = (now - ping_sent_time) / 1000.0f;  // ms

// NetworkMetricsUI.cpp
std::string getQualityIndicator(float rtt) {
    if (rtt < 20.0f) return "â˜…â˜…â˜…â˜…â˜… EXCELLENT";
    if (rtt < 50.0f) return "â˜…â˜…â˜…â˜…â˜† GOOD";
    if (rtt < 100.0f) return "â˜…â˜…â˜…â˜†â˜† ACCEPTABLE";
    // ...
}

// DANS LE JEU
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RTT: 18ms  â˜…â˜…â˜…â˜…â˜…    â”‚ â† Joueur voit qualitÃ©
â”‚ Loss: 0.0%          â”‚   connexion en temps rÃ©el
â”‚ Connection: Stable   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. Compression LZ4 â†’ Bandwidth Optimization

```cpp
// TON TRAVAIL (PacketsManager.cpp)
GameStatePacket: 480 bytes â†’ 182 bytes (62% reduction)

// DANS LE JEU
Sans compression:  480 bytes Ã— 20 Hz = 9.6 KB/s
Avec compression:  182 bytes Ã— 20 Hz = 3.6 KB/s

Ã‰conomie: 6 KB/s par joueur
Pour 4 joueurs: 24 KB/s Ã©conomisÃ©s
â†’ Jeu jouable mÃªme avec connexion 3G!
```

### 6. Room System â†’ Multi-instance Scalability

```cpp
// TON TRAVAIL (RoomManager.cpp)
ServerHub spawns multiple ServerRoom processes

// SCÃ‰NARIO 1: 100 joueurs
ServerHub (lobby)
â”œâ”€ Room 1 (4 players) â†’ ServerRoom #1 on port 5001
â”œâ”€ Room 2 (4 players) â†’ ServerRoom #2 on port 5002
â”œâ”€ Room 3 (4 players) â†’ ServerRoom #3 on port 5003
...
â””â”€ Room 25 (4 players) â†’ ServerRoom #25 on port 5025

// AVANTAGES:
- Crash d'une room n'affecte pas les autres âœ…
- CPU load distribuÃ© sur multiple cores âœ…
- Scaling horizontal possible âœ…
- Isolation entre parties âœ…
```

### 7. Lobby System â†’ Matchmaking UX

```cpp
// TON TRAVAIL (ClientHub + LobbyState)
requestRoomList() â†’ ServerHub returns available rooms
createRoom(name) â†’ ServerHub spawns new ServerRoom
joinRoom(id) â†’ ClientHub receives port, connects UDP

// EXPÃ‰RIENCE JOUEUR:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ R-TYPE MULTIPLAYER LOBBY                       â”‚
â”‚                                                â”‚
â”‚ ROOM NAME       PLAYERS    STATUS              â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚ BeginnersZone   2/4        [Waiting]   [JOIN] â”‚ â† Click
â”‚ HardcoreRun     4/4        [In Game]           â”‚   & play!
â”‚ CoopCampaign    1/4        [Waiting]   [JOIN] â”‚
â”‚                                                â”‚
â”‚ [C] Create Room    [R] Refresh    [ESC] Back   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Au lieu de:
"Enter server IP: ___________"  â† Difficile!
"Enter port: ___________"       â† Pas user-friendly!
```

### 8. Network Metrics UI â†’ Transparency & Debugging

```cpp
// TON TRAVAIL (NetworkMetricsUI.cpp)
Affiche en temps rÃ©el:
- RTT (latency)
- Packet loss
- Bandwidth usage
- FPS

// UTILITÃ‰:
Joueur lag:
  Check metrics â†’ RTT 250ms â˜…â˜†â˜†â˜†â˜†
  â†’ "Ah, c'est ma connexion Internet!"
  
Joueur avec FPS bas:
  Check metrics â†’ RTT 18ms â˜…â˜…â˜…â˜…â˜…, FPS 25
  â†’ "Ah, c'est mon PC qui rame, pas le rÃ©seau!"
  
DÃ©veloppeur:
  Check metrics â†’ Loss 5%, bandwidth 50 KB/s
  â†’ "Trop de packets, need optimization!"
```

---

## ğŸ“š FICHIERS CRÃ‰Ã‰S PAR DEV C

### Networking/client/
```
main_lobby_test.cpp          â† Test lobby CLI
main_metrics_demo.cpp        â† Dashboard metrics terminal
main_graphical_client.cpp    â† Client graphique SFML
```

### RType-Game/States/
```
LobbyState.hpp/cpp           â† Ã‰tat lobby avec UI
(Ã€ crÃ©er: MenuState.hpp/cpp) â† Ã‰tat menu principal
```

### RType-Game/UI/
```
(Ã€ crÃ©er: NetworkMetricsUI.hpp/cpp)  â† Overlay metrics in-game
```

### GameEngine/Physics/
```
Systems/
  PhysicsSystem.cpp/hpp      â† GravitÃ©, vÃ©locitÃ©, boundaries
  CollisionSystem.cpp/hpp    â† DÃ©tection collisions
  ShooterSystem.cpp/hpp      â† Tir automatique
  SpawnSystem.cpp/hpp        â† GÃ©nÃ©ration entitÃ©s

Components/
  Physics.hpp                â† Position, Velocity, etc.
  Movement.hpp               â† Movement-related components
```

### Networking/
```
PacketsManager.hpp/cpp       â† Serialization + compression + metrics
Signal.hpp/cpp               â† Ã‰vÃ©nements callback
compress.cpp                 â† Compression LZ4
encrypt.cpp                  â† Encryption XOR

server/
  ServerHub.cpp/hpp          â† Lobby server (TCP)
  ServerRoom.cpp/hpp         â† Game server (UDP)
  Room.cpp/hpp               â† Room process management
  RoomManager.cpp/hpp        â† Multi-instance manager

client/
  ClientHub.cpp/hpp          â† Lobby client (TCP)
  ClientRoom.cpp/hpp         â† Game client (UDP)
  GameClient.cpp/hpp         â† Client wrapper
```

---

## ğŸš€ PROCHAINES Ã‰TAPES D'INTÃ‰GRATION

### Ã‰tape 1: Compilation (30min)
```bash
cd /home/brith/Epitech/G-CPP-500-COT-5-1-rtype-2
mkdir -p build && cd build
conan install .. --build=missing
cmake .. -DCMAKE_BUILD_TYPE=Release
cmake --build . -j
```

### Ã‰tape 2: Test Existant (30min)
```bash
# Terminal 1: Serveur
./r-type_server 4242

# Terminal 2: Test lobby CLI
./lobby_client_test 4242

# Terminal 3: Test metrics dashboard
./metrics_demo 4242

# Terminal 4: Test graphical client
./r-type_graphical_client 4242
```

### Ã‰tape 3: IntÃ©gration Menu + Lobby (3h)
- CrÃ©er MenuState.hpp/cpp
- Modifier RTypeGame pour state machine
- Tester transition Menu â†’ Lobby â†’ Game

### Ã‰tape 4: IntÃ©gration Network Metrics UI (2h)
- CrÃ©er NetworkMetricsUI.hpp/cpp
- IntÃ©grer dans RTypeGame (overlay in-game)
- Toggle avec F3

### Ã‰tape 5: Tests Finaux (2h)
- Test multi-room (3+ rooms simultanÃ©es)
- Test 4 joueurs dans mÃªme room
- Test metrics avec lag artificiel
- VÃ©rifier compression/bandwidth

**Temps total: ~8h**  
**RÃ©sultat: Jeu R-Type complet et fonctionnel!**
